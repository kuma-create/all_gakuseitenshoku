"use client"
import { useState } from "react"
import {
  Dialog, DialogTrigger, DialogContent, DialogHeader,
  DialogFooter, DialogTitle, DialogClose,
} from "@/components/ui/dialog"
import { ScrollArea } from "@/components/ui/scroll-area"
import { Checkbox } from "@/components/ui/checkbox"
import { Button } from "@/components/ui/button"

const GROUPS: Record<string, string[]> = {
  // === 事務・管理 =====================================================
  "事務・管理": [
    "ビジネス実務法務検定試験（1級）",
    "ビジネス実務法務検定試験（2級）",
    "ビジネス実務法務検定試験（3級）",
    "簿記検定（1級）",
    "簿記検定（2級）",
    "簿記検定（3級）",
    "簿記検定（簿記初級）",
    "簿記検定（原価計算初級）",
    "学芸員資格",
  ],

  // === 教職 ==========================================================
  "教職": ["教員免許", "教員免許取得予定"],

  // === 語学 ==========================================================
  語学: [
    // 漢字検定
    "漢字検定（1級）",
    "漢字検定（準1級）",
    "漢字検定（2級）",
    "漢字検定（準2級）",
    "漢字検定（3級）",

    // TOEIC ※上位→下位
    "TOEIC（945〜）",
    "TOEIC（895〜944）",
    "TOEIC（845〜894）",
    "TOEIC（795〜844）",
    "TOEIC（745〜794）",
    "TOEIC（695〜744）",
    "TOEIC（645〜694）",
    "TOEIC（595〜644）",
    "TOEIC（545〜594）",
    "TOEIC（495〜544）",
    "TOEIC（〜494）",

    // 英検
    "英検（1級）",
    "英検（準1級）",
    "英検（2級）",
    "英検（準2級）",
    "英検（3級）",
    "英検（4級）",

    // TOEFL（iBT 換算表記）
    "TOEFL（iBT: 114〜 / PBT: 650〜 / CBT: 280〜）",
    "TOEFL（iBT: 100〜113 / PBT: 600〜649 / CBT: 250〜279）",
    "TOEFL（iBT: 79〜99 / PBT: 550〜599 / CBT: 213〜249）",
    "TOEFL（iBT: 69〜78 / PBT: 523〜549 / CBT: 193〜212）",
    "TOEFL（iBT: 45〜68 / PBT: 450〜522 / CBT: 133〜192）",
    "TOEFL（iBT: 〜44 / PBT: 〜449 / CBT: 〜132）",

    // IELTS
    "IELTS（9.0）",
    "IELTS（8.5）",
    "IELTS（8.0）",
    "IELTS（7.5）",
    "IELTS（7.0）",
    "IELTS（6.5）",
    "IELTS（6.0）",
    "IELTS（5.5）",
    "IELTS（5.0）",
    "IELTS（4.5）",
    "IELTS（4.0）",
    "IELTS（3.5）",
    "IELTS（3.0以下）",

    // 中国語
    "中国語検定（1級）",
    "中国語検定（準1級）",
    "中国語検定（2級）",
    "中国語検定（3級）",
    "中国語検定（4級）",
    "中国語検定（準4級）",
    "HSK（6級）",
    "HSK（5級）",
    "HSK（4級）",
    "HSK（3級）",
    "HSK（2級）",
    "HSK（1級）",

    // 韓国語
    "韓国語能力試験（6級）",
    "韓国語能力試験（5級）",
    "韓国語能力試験（4級）",
    "韓国語能力試験（3級）",
    "韓国語能力試験（2級）",
    "韓国語能力試験（1級）",
    "韓国語能力評価試験（6級）",
    "韓国語能力評価試験（5級）",
    "韓国語能力評価試験（4級）",
    "韓国語能力評価試験（3級）",
    "韓国語能力評価試験（2級）",
    "韓国語能力評価試験（1級）",
    "ハングル能力検定試験（5級）",
    "ハングル能力検定試験（4級）",
    "ハングル能力検定試験（3級）",
    "ハングル能力検定試験（準2級）",
    "ハングル能力検定試験（2級）",
    "ハングル能力検定試験（1級）",

    // 日本語（留学生向け）
    "BJTビジネス日本語能力テスト（600〜800点）",
    "BJTビジネス日本語能力テスト（530〜599点）",
    "BJTビジネス日本語能力テスト（450〜529点）",
    "BJTビジネス日本語能力テスト（400〜449点）",
    "BJTビジネス日本語能力テスト（200〜399点）",
    "BJTビジネス日本語能力テスト（0〜199点）",
    "日本語検定（1級）",
    "日本語検定（2級）",
    "日本語検定（3級）",
    "日本語検定（4級）",
    "日本語検定（5級）",
    "日本語検定（6級）",
    "日本語検定（7級）",
    "日本語能力試験（N1）",
    "日本語能力試験（N2）",
    "日本語能力試験（N3）",
    "日本語能力試験（N4）",
    "日本語能力試験（N5）",
  ],

  // === 技能（医薬） ===================================================
  "技能（医薬）": ["登録販売者", "薬剤師"],

  // === 技能（医療・福祉） ============================================
  "技能（医療・福祉）": [
    "医師免許",
    "医療管理（TES）",
    "介護福祉士",
    "看護師",
    "准看護師",
    "歯科衛生士",
    "作業療法士",
    "社会福祉士",
    "医療秘書",
    "手話通訳士",
    "保育士",
    "臨床検査技師",
  ],

  // === 技能（技術） ===================================================
  "技能（技術）": [
    // 放射線
    "放射線取扱主任（第1種）",
    "放射線取扱主任（第2種）",
    "放射線取扱主任（第3種）",

    // 介護
    "介護職員初任者研修",
    "介護福祉士実務者研修",

    // 理学・自動車
    "理学療法士",
    "普通自動車第一種運転免許",
    "普通自動車第二種運転免許",
    "準中型自動車免許",

    // 衛生管理
    "第一種衛生管理者",
    "第二種衛生管理者",

    // その他管理
    "エネルギー管理士",
    "危険物取扱者",

    // ------ 技術士（機械） ------
    "技術士（機械、材料力学）",
    "技術士（機械、材料力学・制御）",
    "技術士（機械、熱工学）",
    "技術士（機械、流体工学）",

    // 技術士（船舶・海洋）
    "技術士（船舶・海洋、材料・構造力学）",
    "技術士（船舶・海洋、浮体の力学）",
    "技術士（船舶・海洋、計測・制御）",
    "技術士（船舶・海洋、機械及びシステム）",

    // 技術士（航空・宇宙）
    "技術士（航空・宇宙、機体システム）",
    "技術士（航空・宇宙、航空援助施設）",
    "技術士（航空・宇宙、宇宙環境利用）",

    // 応用理学
    "技術士（応用理学、物理及び化学）",
    "技術士（応用理学、地球物理及び地球化学）",
    "技術士（応用理学、地質）",

    // 生物工学
    "技術士（生物工学、細胞遺伝子工学）",
    "技術士（生物工学、生物化学工学）",
    "技術士（生物工学、生物環境工学）",

    // 環境
    "技術士（環境、大気、水、土壌等の環境の保全）",
    "技術士（環境、地球環境の保全）",
    "技術士（環境、廃棄物等の物質循環の管理）",
    "技術士（環境、環境の状況の測定分析及び監視）",
    "技術士（環境、自然生態系及び風景の保全）",
    "技術士（環境、自然環境の再生・修復及び自然とのふれあい推進）",

    // 原子力
    "技術士（原子力・放射線、原子力）",
    "技術士（原子力・放射線、放射線）",
    "技術士（原子力・放射線、エネルギー）",

    // 建築士
    "一級建築士",
    "二級建築士",
    "木造建築士",

    // その他資格
    "インテリアコーディネーター",
    "自動車整備士",
    "厨房設備士（1級）",
    "厨房設備士（2級）",

    // 電気工事士 / 主任技術者
    "第一種電気工事士",
    "第二種電気工事士",
    "第一種電気主任技術者",
    "第二種電気主任技術者",
    "第三種電気主任技術者",

    // 電気通信
    "電気通信主任技術者（伝送交換主任技術者資格者証）",
    "電気通信主任技術者（線路主任技術者資格者証）",
    "電気通信の工事担任者（第一級アナログ通信）",
    "電気通信の工事担任者（第二級アナログ通信）",
    "電気通信の工事担任者（第一級デジタル通信）",
    "電気通信の工事担任者（第二級デジタル通信）",
    "電気通信の工事担任者（総合通信）",

    // 毒物劇物
    "毒物劇物取扱責任者（一般）",
    "毒物劇物取扱責任者（農業用品目）",

    // 測量
    "測量士",
    "測量士補",

    // 建築物環境衛生
    "建築物環境衛生管理技術者（ビル管理技術者）",

    // 冷凍機械
    "第一種冷凍機械",
    "第二種冷凍機械",
    "第三種冷凍機械",

    // 理美容
    "理容師",
    "美容師",

    // 調理
    "調理師",
    "調理技術技能（すし料理）",
    "調理技術技能（中国料理）",
    "調理技術技能（給食用特殊料理）",
    "調理技術技能（日本料理）",
    "調理技術技能（西洋料理）",
    "調理技術技能（麺料理）",

    // 動物
    "獣医師",
    "トリマー（師範）",
    "トリマー（教士）",
    "トリマー（A級）",
    "トリマー（B級）",
    "トリマー（C級）",

    // 統計
    "統計検定1級",
    "統計検定準1級",
    "統計検定2級",
    "統計検定3級",
    "統計検定4級",
    "統計検定統計調査士",
    "統計検定専門統計調査士",
    "統計検定データサイエンス基礎",
    "統計検定データサイエンス発展",
    "統計検定データサイエンスエキスパート",
  ],

  // === 技能（金融・会計・不動産） ===================================
  "技能（金融・会計・不動産）": [
    "公認会計士",
    "CMA第1次レベル",
    "CMA第2次レベル",
    "証券アナリスト（CMA）",
    "国際公認投資アナリスト（CIIA）",
    "外務員",
    "税理士",
    "宅地建物取引士",
    "不動産鑑定士",
    "米国公認会計士（USCPA）（FAR、財務会計）",
    "米国公認会計士（USCPA）（BEC、ビジネス環境および諸概念）",
    "米国公認会計士（USCPA）（AUD、監査および証明業務）",
    "米国公認会計士（USCPA）（REG、諸法規）",
    "管理業務主任者",

    // 簿記
    "日商簿記（1級）",
    "日商簿記（2級）",
    "日商簿記（3級）",
    "日商簿記（簿記初級）",
    "日商簿記（原価計算初級）",

    // ファイナンシャルプランナー
    "ファイナンシャルプランナー（1級）",
    "ファイナンシャルプランナー（2級）",
    "ファイナンシャルプランナー（3級）",
    "AFP認定者",
    "CFP認定者",

    // 銀行業務検定（追加分）
    "銀行業務検定（金融商品取引3級）",
    "銀行業務検定（預かり資産アドバイザー2級）",
    "銀行業務検定（預かり資産アドバイザー3級）",
    "銀行業務検定（保険販売3級）",
    "銀行業務検定（相続アドバイザー2級）",
    "銀行業務検定（相続アドバイザー3級）",

    // 既存銀行業務検定（前パッチ分）
    "銀行業務検定（融資管理3級）",
    "銀行業務検定（法務2級）",
    "銀行業務検定（法務3級）",
    "銀行業務検定（法務4級）",
    "銀行業務検定（財務4級）",
    "銀行業務検定（財務2級）",
    "銀行業務検定（税務3級）",
    "銀行業務検定（税務4級）",
    "銀行業務検定（年金アドバイザー2級）",
    "銀行業務検定（年金アドバイザー3級）",
    "銀行業務検定（年金アドバイザー4級）",
    "銀行業務検定（証券3級）",
    "銀行業務検定（信託実務3級）",
    "銀行業務検定（金利リスクマネジメント2級）",
    "銀行業務検定（営業店マネジメントⅠ）",
    "銀行業務検定（営業店マネジメントⅡ）",
    "銀行業務検定（経営支援アドバイザー2級）",
    "銀行業務検定（窓口セールス3級）",
    "銀行業務検定（法人融資渉外2級）",
    "銀行業務検定（法人融資渉外3級）",
    "銀行業務検定（事業性評価3級）",
    "銀行業務检定（個人融資渉外3級）",
    "銀行業務検定（デリバティブ3級）",
    "銀行業務検定（事業継承アドバイザー3級）",
    "銀行業務検定（外国為替2級）",
    "銀行業務検定（外国為替3級）",
    "銀行業務検定（金融経済3級）",
    "銀行業務検定（投資信託2級）",
    "銀行業務検定（投資信託3級）",
  ],

  // === 技能（法律・労務・経営） =====================================
  "技能（法律・労務・経営）": [
    "行政書士",
    "司法試験合格",
    "司法書士",
    "社会保険労務士",
    "中小企業診断士",
    "通関士",
    "弁理士",
    "一級知的財産管理技能士（特許専門業務）",
    "一級知的財産管理技能士（コンテンツ専門業務）",
    "一級知的財産管理技能士（ブランド専門業務）",
    "二級知的財産管理技能士（管理業務）",
    "三級知的財産管理技能士（管理業務）",
  ],

  // === 技能（その他） ===============================================
  "技能（その他）": [
    "栄養士",
    "管理栄養士",
    "気象予報士",
    "総合旅行業務取扱管理者",
    "国内旅行業務取扱管理者",

    // 販売士
    "販売士（1級）",
    "販売士（2級）",
    "販売士（3級）",

    // 書写検定
    "硬筆書写検定（1級）",
    "硬筆書写検定（準1級）",
    "硬筆書写検定（2級）",
    "硬筆書写検定（準2級）",
    "硬筆書写検定（3級）",
    "毛筆書写検定（1級）",
    "毛筆書写検定（準1級）",
    "毛筆書写検定（2級）",
    "毛筆書写検定（準2級）",
    "毛筆書写検定（3級）",

    // 色彩検定
    "色彩検定1級",
    "色彩検定2級",
    "色彩検定3級",
    "色彩検定UC級",

    // 社会調査
    "社会調査士",
    "専門社会調査士",
  ],

  // === 情報処理技術者試験 ===========================================
  情報処理技術者試験: [
    "ITパスポート",
    "情報セキュリティマネジメント",
    "基本情報技術者",
    "応用情報技術者",
    "ITストラテジスト",
    "システムアーキテクト",
    "プロジェクトマネージャ",
    "ネットワークスペシャリスト",
    "データベーススペシャリスト",
    "エンベデッドシステムスペシャリスト",
    "ITサービスマネージャ",
    "システム監査技術者試験",
    "情報処理安全確保支援士（試験合格のみ）",
    "情報処理安全確保支援士",
    "初級システムアドミニストレータ試験",
  ],

  // === コンピュータ資格 =============================================
  コンピュータ資格: [
    // 2次元CAD
    "2次元CAD利用技術者試験（1級）",
    "2次元CAD利用技術者試験（1級）（機械）",
    "2次元CAD利用技術者試験（1級）（建築）",
    "2次元CAD利用技術者試験（1級）（トレース）",
    "2次元CAD利用技術者試験（2級）",
    "2次元CAD利用技術者試験（基礎）",

    // 3次元CAD
    "3次元CAD利用技術者試験（1級）",
    "3次元CAD利用技術者試験準（1級）",
    "3次元CAD利用技術者試験（2級）",

    // ネットワーク
    "Cisco Certified Network Associate（CCNA）",

    // CIW
    "CIW（Web Fundation）",
    "CIW（Internet Business）",
    "CIW（Site Development）",
    "CIW（Network Technology）",
    "CIW（HTML5 and CSS3）",
    "CIW（User Interface）",
    "CIW（Social Media）",
    "CIW（Data Analyst）",
    "CIW（Web Design）",
    "CIW（E-Commerce）",
    "CIW（Java Script）",
    "CIW（Database Design）",
    "CIW（Perl）",
    "CIW（Web Security Specialist）",
    "CIW（Web Security Associate）",

    // DTP
    "DTPエキスパート・マイスター",
    "DTPエキスパート",

    // Java / C
    "Javaプログラミング能力検定（1級）",
    "Javaプログラミング能力検定（2級）",
    "Javaプログラミング能力検定（3級）",
    "C言語プログラミング能力検定（1級）",
    "C言語プログラミング能力検定（2級）",
    "C言語プログラミング能力検定（3級）",

    // LinuC / LPIC
    "LinuC（レベル1）",
    "LinuC（レベル2）",
    "LinuC（レベル3）（300）",
    "LinuC（レベル3）（303）",
    "LinuC（レベル3）（304）",
    "LPI（Linux Essentials）",
    "LPI（LPIC-1）",
    "LPI（LPIC-2）",
    "LPI（LPIC-3 Mixed Environment）",
    "LPI（LPIC-3 Security）",
    "LPI（LPIC-3 Virtualization and High Availability）",
    "LPI（DevOps）",
    "LPI（BSD）",

    // UMTP
    "UMTP（L1）",
    "UMTP（L2）",
    "UMTP（L3）",
    "UMTP（L4）",

    // Oracle
    "ORACLE MASTER 2019（Platinum DBA）",
    "ORACLE MASTER 2019（Gold DBA）",
    "ORACLE MASTER 2019（Silver DBA）",
    "ORACLE MASTER 2019（Bronze DBA）",
    "ORACLE MASTER 2019（Silver SQL）",

    // 日商 PC 検定
    "日商PC検定（1級）",
    "日商PC検定（2級）",
    "日商PC検定（3級）",
    "日商PC検定（ベーシック）",

    // P 検
    "P検（1級）",
    "P検（2級）",
    "P検（準2級）",
    "P検（3級）",

    // MOS
    "MOS Word",
    "MOS Wordエキスパート",
    "MOS Excel",
    "MOS Excelエキスパート",
    "MOS PowerPoint",
    "MOS Access",
    "MOS Accessエキスパート",
    "MOS Outlook",
  ],
}

export default function QualificationPicker({
  values,
  onChange,
}: {
  values: string[]
  onChange: (vals: string[]) => void
}) {
  /* ローカル選択状態（OK を押すまで commit しない） */
  const [temp, setTemp] = useState<string[]>(values)

  const toggle = (label: string, checked: boolean) =>
    setTemp((prev) =>
      checked ? [...prev, label] : prev.filter((v) => v !== label),
    )

  return (
    <Dialog>
      <DialogTrigger asChild>
        <Button variant="outline" className="w-full">
          資格を追加
        </Button>
      </DialogTrigger>

      <DialogContent className="sm:max-w-lg">
        <DialogHeader>
          <DialogTitle>資格を選択</DialogTitle>
        </DialogHeader>

        <ScrollArea className="h-[60vh] pr-2">
          {Object.entries(GROUPS).map(([group, items]) => (
            <div key={group} className="mb-4">
              <h4 className="mb-1 text-sm font-semibold text-muted-foreground">
                {group}
              </h4>

              {items.map((label) => {
                const checked = temp.includes(label)
                return (
                  <label
                    key={label}
                    className="flex cursor-pointer items-center gap-2 py-1"
                  >
                    <Checkbox
                      checked={checked}
                      onCheckedChange={(v) => toggle(label, !!v)}
                    />
                    <span className="text-sm">{label}</span>
                  </label>
                )
              })}
            </div>
          ))}
        </ScrollArea>

        <DialogFooter>
          <DialogClose asChild>
            <Button
              onClick={() => onChange(temp)}
              className="w-full sm:w-auto"
            >
              追加する
            </Button>
          </DialogClose>
        </DialogFooter>
      </DialogContent>
    </Dialog>
  )
}